import{R as g,c as fe,q as i,o as f,X as _,r as G,u as ge,a as we,e as he,Y as ye,S as be,Q as ve,Z as Pe,$ as A,a0 as Ce,D as b,O as _e,a1 as Se,b as Ie,a2 as Oe,a3 as D,a4 as R,a5 as xe,E as m,a6 as k,a7 as $e,a8 as Ue,W as ze,a9 as E}from"./index-803be323.js";import{I as q}from"./use-form-bb9108ba.js";import{u as Le}from"./use-uncontrolled-2c825d87.js";const Ae=({reveal:e,size:r})=>g.createElement("svg",{width:r,height:r,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},g.createElement("path",{d:e?"M13.3536 2.35355C13.5488 2.15829 13.5488 1.84171 13.3536 1.64645C13.1583 1.45118 12.8417 1.45118 12.6464 1.64645L10.6828 3.61012C9.70652 3.21671 8.63759 3 7.5 3C4.30786 3 1.65639 4.70638 0.0760002 7.23501C-0.0253338 7.39715 -0.0253334 7.60288 0.0760014 7.76501C0.902945 9.08812 2.02314 10.1861 3.36061 10.9323L1.64645 12.6464C1.45118 12.8417 1.45118 13.1583 1.64645 13.3536C1.84171 13.5488 2.15829 13.5488 2.35355 13.3536L4.31723 11.3899C5.29348 11.7833 6.36241 12 7.5 12C10.6921 12 13.3436 10.2936 14.924 7.76501C15.0253 7.60288 15.0253 7.39715 14.924 7.23501C14.0971 5.9119 12.9769 4.81391 11.6394 4.06771L13.3536 2.35355ZM9.90428 4.38861C9.15332 4.1361 8.34759 4 7.5 4C4.80285 4 2.52952 5.37816 1.09622 7.50001C1.87284 8.6497 2.89609 9.58106 4.09974 10.1931L9.90428 4.38861ZM5.09572 10.6114L10.9003 4.80685C12.1039 5.41894 13.1272 6.35031 13.9038 7.50001C12.4705 9.62183 10.1971 11 7.5 11C6.65241 11 5.84668 10.8639 5.09572 10.6114Z":"M7.5 11C4.80285 11 2.52952 9.62184 1.09622 7.50001C2.52952 5.37816 4.80285 4 7.5 4C10.1971 4 12.4705 5.37816 13.9038 7.50001C12.4705 9.62183 10.1971 11 7.5 11ZM7.5 3C4.30786 3 1.65639 4.70638 0.0760002 7.23501C-0.0253338 7.39715 -0.0253334 7.60288 0.0760014 7.76501C1.65639 10.2936 4.30786 12 7.5 12C10.6921 12 13.3436 10.2936 14.924 7.76501C15.0253 7.60288 15.0253 7.39715 14.924 7.23501C13.3436 4.70638 10.6921 3 7.5 3ZM7.5 9.5C8.60457 9.5 9.5 8.60457 9.5 7.5C9.5 6.39543 8.60457 5.5 7.5 5.5C6.39543 5.5 5.5 6.39543 5.5 7.5C5.5 8.60457 6.39543 9.5 7.5 9.5Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}));var De=Object.defineProperty,Ee=Object.defineProperties,Ne=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertySymbols,Te=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable,H=(e,r,s)=>r in e?De(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,N=(e,r)=>{for(var s in r||(r={}))Te.call(r,s)&&H(e,s,r[s]);if(Z)for(var s of Z(r))je.call(r,s)&&H(e,s,r[s]);return e},Y=(e,r)=>Ee(e,Ne(r)),We=fe((e,{rightSectionWidth:r},{size:s})=>({visibilityToggle:{},input:{position:"relative",overflow:"hidden"},innerInput:Y(N(N({},e.fn.fontStyles()),e.fn.cover(0)),{backgroundColor:"transparent",border:`${i(1)} solid transparent`,borderLeftWidth:0,borderRightWidth:0,boxSizing:"border-box",display:"block",width:`calc(100% - ${i(r)})`,paddingLeft:`calc(${f({size:s,sizes:_})}  / 3)`,fontSize:f({size:s,sizes:e.fontSizes}),height:`calc(${f({size:s,sizes:_})} - ${i(2)})`,lineHeight:`calc(${f({size:s,sizes:_})} - ${i(4)})`,color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,"&::-ms-reveal, &::-ms-clear":{display:"none"},"&:focus":{outline:0},"&:disabled":{cursor:"not-allowed"},"&::placeholder":Y(N({},e.fn.placeholderStyles()),{opacity:1}),"&[data-invalid]":{color:e.fn.variant({variant:"filled",color:"red"}).background,"&::placeholder":{opacity:1,color:e.fn.variant({variant:"filled",color:"red"}).background}},"&[data-with-icon]":{paddingLeft:f({size:s,sizes:_})}})}));const Ve=We;var Me=Object.defineProperty,Re=Object.defineProperties,ke=Object.getOwnPropertyDescriptors,O=Object.getOwnPropertySymbols,K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable,B=(e,r,s)=>r in e?Me(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,S=(e,r)=>{for(var s in r||(r={}))K.call(r,s)&&B(e,s,r[s]);if(O)for(var s of O(r))Q.call(r,s)&&B(e,s,r[s]);return e},qe=(e,r)=>Re(e,ke(r)),Ze=(e,r)=>{var s={};for(var l in e)K.call(e,l)&&r.indexOf(l)<0&&(s[l]=e[l]);if(e!=null&&O)for(var l of O(e))r.indexOf(l)<0&&Q.call(e,l)&&(s[l]=e[l]);return s};const He={xs:i(22),sm:i(26),md:i(28),lg:i(32),xl:i(40)},Ye={xs:i(12),sm:i(15),md:i(17),lg:i(19),xl:i(21)},Be={xs:i(28),sm:i(32),md:i(34),lg:i(44),xl:i(54)},Ge={size:"sm",toggleTabIndex:-1,visibilityToggleIcon:Ae,__staticSelector:"PasswordInput"},Ke=G.forwardRef((e,r)=>{const s=ge("PasswordInput",Ge,e),{radius:l,disabled:h,size:p,toggleTabIndex:x,className:$,id:U,label:v,error:t,required:a,style:n,icon:d,description:o,wrapperProps:u,classNames:c,styles:w,variant:y,visibilityToggleIcon:X,__staticSelector:T,rightSection:Qe,rightSectionWidth:Xe,rightSectionProps:Fe,sx:F,labelProps:J,descriptionProps:ee,errorProps:te,unstyled:P,visibilityToggleLabel:j,withAsterisk:re,inputContainer:se,iconWidth:ae,inputWrapperOrder:oe,visible:ie,defaultVisible:ne,onVisibilityChange:le}=s,ce=Ze(s,["radius","disabled","size","toggleTabIndex","className","id","label","error","required","style","icon","description","wrapperProps","classNames","styles","variant","visibilityToggleIcon","__staticSelector","rightSection","rightSectionWidth","rightSectionProps","sx","labelProps","descriptionProps","errorProps","unstyled","visibilityToggleLabel","withAsterisk","inputContainer","iconWidth","inputWrapperOrder","visible","defaultVisible","onVisibilityChange"]),W=f({size:p,sizes:Be}),{classes:z}=Ve({rightSectionWidth:W},{name:"PasswordInput",classNames:c,styles:w,unstyled:P,size:p,variant:y}),V=we(U),{systemStyles:de,rest:ue}=he(ce),[L,pe]=Le({value:ie,defaultValue:ne,finalValue:!1,onChange:le}),M=()=>pe(!L),me=g.createElement(ye,{className:z.visibilityToggle,tabIndex:x,radius:l,size:f({size:p,sizes:He}),"aria-hidden":!j,"aria-label":j,unstyled:P,onMouseDown:C=>{C.preventDefault(),M()},onKeyDown:C=>{C.key===" "&&(C.preventDefault(),M())}},g.createElement(X,{reveal:L,size:f({size:p,sizes:Ye})}));return g.createElement(q.Wrapper,S(S({required:a,id:V,label:v,error:t,description:o,size:p,className:$,style:n,classNames:c,styles:w,__staticSelector:T,sx:F,errorProps:te,descriptionProps:ee,labelProps:J,unstyled:P,withAsterisk:re,inputWrapperOrder:oe,inputContainer:se,variant:y},de),u),g.createElement(q,{component:"div",error:t,icon:d,size:p,classNames:qe(S({},c),{input:z.input}),styles:w,radius:l,disabled:h,__staticSelector:T,rightSectionWidth:W,rightSection:!h&&me,variant:y,unstyled:P,iconWidth:ae},g.createElement("input",S({type:L?"text":"password",required:a,"data-invalid":!!t||void 0,"data-with-icon":!!d||void 0,className:z.innerInput,disabled:h,id:V,ref:r},ue))))});Ke.displayName="@mantine/core/PasswordInput";const I="https://pandolfom.github.io/Maneeley/";function rt(){const e=be(),{currentUser:r,setCurrentUser:s}=G.useContext(ve),l=async()=>{let t=[];const a=Pe(A(m,"users"));return(await Ce(a)).forEach(d=>{t.push(d.data())}),t},h=async t=>{const a=b(m,"users",t),n=await _e(a);return n.exists()?n.data():!1},p=async(t,a,n)=>{r.uid===t.uid?Se.openConfirmModal({title:"Continue?",children:Ie("p",{children:"Are you sure you would like to remove yourself as admin?"}),labels:{confirm:"Confirm",cancel:"Cancel"},onCancel:()=>{},onConfirm:async()=>{await v(t,a,n),Oe(ze),s(null),e("/")}}):await v(t,a,n)},x=async(t,a,n)=>{var c;const o=await D(E,"createUser")(t);if((c=o.data)!=null&&c.errorInfo)return o.data.errorInfo.message;t.customPassword&&await R(A(m,"mail"),{to:t.email,message:{subject:"Account Activated",text:`Your account is waiting to for you! Login at ${I} with your temporary password "${o.data.tempPass}"`,html:`
          <h1>Your account is waiting for you!</h1>
          <p>Log into the <a href="${I}">dashboard</a> with your temporary password "${o.data.tempPass}"</p>
          `}}),await xe(b(m,"users",o.data.uid),{email:t.email,username:t.username,uid:o.data.uid,tempPassword:t.customPassword});let u=[...a];u.push({email:t.email,username:t.username,uid:o.data.uid,tempPassword:t.customPassword}),n(u)},$=async(t,a,n)=>{var w;const o=await D(E,"updateUser")(t);if((w=o.data)!=null&&w.errorInfo)return o.data.errorInfo.message;t.customPassword&&await R(A(m,"mail"),{to:t.email,message:{subject:"Password Reset",text:`Your password has been reset! Login at ${I} with your temporary password '${o.data.tempPass}' to create a new one.`,html:`
          <h1>Your password has been reset!</h1>
          <p>Log into the <a href="${I}">dashboard</a> with your temporary password "${o.data.tempPass}" to create a new one.</p>
          `}}),await k(b(m,"users",o.data.uid),{email:t.email,username:t.username,tempPassword:t.customPassword});let u=[...a];const c=a.findIndex(y=>y.uid===o.data.uid);u[c]={email:t.email&&t.email,username:t.username&&t.username,uid:o.data.uid,tempPassword:t.customPassword},n(u)},U=async(t,a,n)=>{await $e(a,t).then(()=>{if(n)return k(b(m,"users",a.uid),{tempPassword:!1})}).catch(d=>d)},v=async(t,a,n)=>{await D(E,"deleteAuth")({uid:t.uid}),await Ue(b(m,"users",t.uid));let o=[...a];const u=a.findIndex(c=>c.uid===t.uid);o.splice(u,1),n(o)};return{getUsers:l,getUser:h,deleteUserData:p,createUser:x,resetPassword:U,updateUser:$}}export{Ke as P,rt as u};
